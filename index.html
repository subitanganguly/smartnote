<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SmartNote V2</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0d6efd">
    <link rel="stylesheet" href="style/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="js/gradient-loader.js"></script>
    <script src="js/auth.js"></script>
</head>
  <body>
     <div class="area" >
        <ul class="circles">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
        </ul>

    <nav class="navbar bg-light fixed-top">
  <div class="container">
    <a class="navbar-brand" href="#">
    <img src="img/logo.png" alt="Bootstrap" width="40" height="34" class="brand-logo">
    <span id="greetingMessage" class="mb-0">Welcome!</span>
    </a>
    <div class="d-flex align-items-center">
    <div class="dropstart" >
    <a class="btn" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fa-solid fa-gear" style="font-size: larger;"></i>
    </a>

    <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="theme.html"><i class="fa-brands fa-themeisle"></i> Theme</a></li>
        <li><a class="dropdown-item d-none" href="admin_report.html"  id="adminLink"><i class="fas fa-database"></i> App Users</a></li>
        <li><a class="dropdown-item " href="feedback.html"><i class="fas fa-thumbs-up"></i> Feedback</a></li>
        <li><a  class="dropdown-item" href="#" id="logoutButton"><i class="fa-solid fa-right-from-bracket"></i> Log Out</a></li>
    </ul>
  </div>
    </div>
  </div>
   </nav>
  
   <div class="container main-content" style="margin-top: 100px;">

    <div class="container text-center">
  <div class="row g-2">
        <div class="col-6 mb-2">
            <a href="note.html" class="text-decoration-none">
                <div class="p-4 border glass d-flex align-items-center justify-content-center flex-column text-center  hover-card">
                <i class="fas fa-book icons-index"></i>
                <span class="icons-index-text">Notes</span>
                </div>
            </a>
        </div>
        <div class="col-6 mb-2">
            <a href="expenditure.html" class="text-decoration-none">
                <div class="p-4 border glass d-flex align-items-center justify-content-center flex-column text-center hover-card">
                <i class="fas fa-wallet icons-index"></i>
                <span class="icons-index-text">Expenditure</span>
                </div>
            </a>
        </div>
        <div class="col-6 mb-2">
            <a href="password.html" class="text-decoration-none">
                <div class="p-4 border glass d-flex align-items-center justify-content-center flex-column text-center hover-card">
                <i class="fas fa-lock icons-index"></i>
                <span class="icons-index-text">passwords</span>
                </div>
            </a>
        </div>
        <div class="col-6 mb-2">
            <a href="calendar.html" class="text-decoration-none">
                <div class="p-4 border glass d-flex align-items-center justify-content-center flex-column text-center hover-card">
                <i class="fas fa-calendar-alt icons-index"></i>
                <span class="icons-index-text">Calendar</span>
                </div>
            </a>
        </div>
        <div class="col-6 mb-2">
            <a href="records.html" class="text-decoration-none">
                <div class="p-4 border glass d-flex align-items-center justify-content-center flex-column text-center hover-card">
                    <i class="fas fa-file-alt icons-index"></i>
                    <span class="icons-index-text">Records</span>
                </div>
            </a>
        </div>

        <div class="col-6 mb-2">
            <a href="qr-index.html" class="text-decoration-none">
                <div class="p-4 border glass d-flex align-items-center justify-content-center flex-column text-center  hover-card">
                <i class="fas fa-indian-rupee-sign icons-index"></i>
                <span class="icons-index-text">UPI to Qr</span>
                </div>
            </a>
        </div>
        <div class="col-6 mb-2">
            <a href="pdf.html" class="text-decoration-none">
                <div class="p-4 border glass d-flex align-items-center justify-content-center flex-column text-center hover-card">
                <i class="fas fa-file-pdf icons-index"></i>
                <span class="icons-index-text">Convert to PDF</span>
                </div>
            </a>
        </div>


    
  </div>
</div>
</div>
</div>

 <script>
  
        // Firebase Authentication State Listener
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;

                // Check user role from localStorage
                const userRole = localStorage.getItem("userRole");
                if (userRole === "admin") {
                    document.getElementById("adminLink").classList.remove("d-none");
                }

                // Extract user ID
                const userId = user.uid;

                // Get the first name, fallback to 'User' if displayName is null
                const firstName = user.displayName ? user.displayName.split(' ')[0] : 'User';

                // Ensure greetingMessage element exists before updating it
                const greetingElement = document.getElementById("greetingMessage");
                if (greetingElement) {
                    greetingElement.innerHTML = `Hello <b>${firstName}</b>,</span> Welcome`;
                } else {
                    console.error("Element with ID 'greetingMessage' not found.");
                }

                // Update `lastUse` in Firebase Database
                firebase.database().ref(`users/${userId}`).update({
                    lastUse: Date.now(),
                    lastUseFormatted: new Date().toLocaleString()
                }).then(() => {
                    //console.log("Last use timestamp updated successfully.");
                }).catch((error) => {
                    console.error("Error updating last use timestamp:", error);
                });

            } else {
                window.location.href = "login.html"; // Redirect to login if not authenticated
            }
        });

        // Log out function
        document.getElementById("logoutButton").addEventListener("click", () => {
            firebase.auth().signOut().then(() => {
                window.location.href = "login.html";
            }).catch((error) => {
                alert("Error logging out: " + error.message);
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    
  </body>
</html>